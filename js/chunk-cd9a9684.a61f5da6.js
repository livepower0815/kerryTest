(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cd9a9684"],{"0064":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"container-fluid"},[s("section",[s("h4",{staticClass:"text-green"},[t._v("\n      目前篩選條件\n      "),s("button",{staticClass:"btn btn-default btn-sm m-0",on:{click:t.toSearchFilter}},[t._v("修改條件")])]),s("div",{staticClass:"list badgets mb-4"},t._l(t.filters,function(e,a){return s("span",{key:"filter-item-"+a,staticClass:"item badget gray"},[t._v("\n        "+t._s(e)+"\n      ")])}))]),s("section",[s("table",{staticClass:"table datatable table-striped table-bordered",attrs:{id:"datatable"}},[s("thead",[s("tr",[s("th",{attrs:{width:"140px"}},[s("div",{staticClass:"checkbox checkbox-inline mr-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkAll,expression:"checkAll"}],attrs:{type:"checkbox",name:"check-all",id:"check-all",value:"1"},domProps:{checked:Array.isArray(t.checkAll)?t._i(t.checkAll,"1")>-1:t.checkAll},on:{change:function(e){var s=t.checkAll,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n="1",r=t._i(s,n);a.checked?r<0&&(t.checkAll=s.concat([n])):r>-1&&(t.checkAll=s.slice(0,r).concat(s.slice(r+1)))}else t.checkAll=i}}}),s("label",{attrs:{for:"check-all"}})]),t._v("\n            #\n          ")]),s("th",{attrs:{width:"100px"}},[t._v("姓名")]),s("th",[t._v("身分證")]),s("th",[t._v("手機")]),s("th",[t._v("電話")]),s("th",[t._v("生日")]),s("th",{attrs:{width:"*"}},[t._v("住家地址")]),s("th",{attrs:{width:"110px"}},[t._v("公司往來")])])]),t.tableData.length?s("tbody",t._l(t.tableData,function(e,a){return s("tr",{key:"td-"+a},[s("td",[s("div",{staticClass:"checkbox checkbox-inline mr-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.selection,expression:"selection"}],attrs:{type:"checkbox",name:"td-item",id:"check-"+a},domProps:{value:e.id,checked:Array.isArray(t.selection)?t._i(t.selection,e.id)>-1:t.selection},on:{change:function(s){var a=t.selection,i=s.target,n=!!i.checked;if(Array.isArray(a)){var r=e.id,o=t._i(a,r);i.checked?o<0&&(t.selection=a.concat([r])):o>-1&&(t.selection=a.slice(0,o).concat(a.slice(o+1)))}else t.selection=n}}}),s("label",{attrs:{for:"check-"+a}})]),s("span",{staticClass:"no"},[t._v(t._s(a))]),s("span",{staticClass:"info text-center"},[s("level",{attrs:{lv:Number(e.vip_level)}}),s("avatar",{attrs:{gender:Number(e.sex),size:20}})],1)]),s("td",[s("a",{staticClass:"link text-underline",on:{click:function(s){t.routeToCustDetail(e.index,e.id)}}},[t._v("\n              "+t._s(e.name)+"\n            ")])]),s("td",[t._v(t._s(e.id))]),s("td",[t._v(t._s(e.mobile))]),s("td",[t._v(t._s(e.phone))]),s("td",[s("div",{staticClass:"date"},[t._v(t._s(t._f("dateFormat")(e.birthday)))]),s("div",{staticClass:"age"},[s("b",[t._v(t._s(t._f("ageCounter")(e.birthday)))]),t._v("歲\n            ")])]),s("td",[t._v(t._s(e.address))]),s("td",[s("div",{staticClass:"list inline"},[s("span",{staticClass:"tag-box",class:{active:e.idmark.indexOf("1")>-1}},[t._v("\n                要\n              ")]),s("span",{staticClass:"tag-box",class:{active:e.idmark.indexOf("2")>-1}},[t._v("\n                被\n              ")]),s("span",{staticClass:"tag-box",class:{active:e.idmark.indexOf("3")>-1}},[t._v("\n                意\n              ")]),s("span",{staticClass:"tag-box",class:{active:e.idmark.indexOf("4")>-1}},[t._v("\n                產\n              ")]),s("span",{staticClass:"tag-box",class:{active:e.idmark.indexOf("5")>-1}},[t._v("\n                團\n              ")]),s("span",{staticClass:"tag-box",class:{active:e.idmark.indexOf("6")>-1}},[t._v("\n                借\n              ")])])])])})):s("tbody",[s("tr",[s("td",{staticClass:"empty-block",attrs:{colspan:"8"}},[s("h3",[t._v(t._s(this.remoteDataMsg))])])])])])]),s("section",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"}),t._m(0),s("div",{staticClass:"col-3 col-sm-4 col-md-4 text-right"},[s("button",{staticClass:"btn btn-primary",attrs:{disabled:!t.selection.length},on:{click:function(e){t.panelOpen("groupModalOpen")}}},[t._v("\n          加入群組\n        ")]),s("button",{staticClass:"btn btn-primary",attrs:{disabled:!t.selection.length},on:{click:function(e){t.panelOpen("printModalOpen")}}},[t._v("\n          列印名條\n        ")])])])]),s("print-modal",{attrs:{open:t.printModalOpen,custs:t.selection},on:{close:function(e){t.panelClose("printModalOpen")}}}),s("group-modal",{attrs:{open:t.groupModalOpen,custs:t.selection},on:{submit:t.submitGroup,close:function(e){t.panelClose("groupModalOpen")}}})],1)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-9 col-sm-8 col-md-8"},[s("div",{staticClass:"list inline"},[s("div",{staticClass:"item"},[s("span",{staticClass:"tag-box"},[t._v("要")]),s("small",{staticClass:"text"},[t._v("壽險要保人")])]),s("div",{staticClass:"item"},[s("span",{staticClass:"tag-box"},[t._v("被")]),s("small",{staticClass:"text"},[t._v("壽險主被保人")])]),s("div",{staticClass:"item"},[s("span",{staticClass:"tag-box"},[t._v("意")]),s("small",{staticClass:"text"},[t._v("意外被保險人")])]),s("div",{staticClass:"item"},[s("span",{staticClass:"tag-box"},[t._v("團")]),s("small",{staticClass:"text"},[t._v("團險被保人")])]),s("div",{staticClass:"item"},[s("span",{staticClass:"tag-box"},[t._v("借")]),s("small",{staticClass:"text"},[t._v("房貸借款人")])]),s("div",{staticClass:"item"},[s("span",{staticClass:"tag-box"},[t._v("產")]),s("small",{staticClass:"text"},[t._v("產險客戶")])])])])}],n=(s("96cf"),s("1da1")),r=s("ade3"),o=(s("7f7f"),s("c5f6"),s("ac6a"),s("456d"),s("be94")),c=s("872c"),l=s("2f62"),d=s("e73d"),u=s("21e1"),p=s("df3a"),m=s("28fe"),h=s("8e44"),f={name:"FilterResult",mixins:[c["a"]],watch:{checkAll:"toggleCheckAll"},components:{PrintModal:d["a"],GroupModal:u["a"],Avatar:p["a"],Level:m["a"]},computed:Object(o["a"])({},Object(l["c"])(["BaseUrl"])),data:function(){return{remoteDataMsg:"資料讀取中，請稍候...",filters:[],groupModalOpen:!1,printModalOpen:!1,checkAll:!1,selection:[],customerType:["1","2","3","4","5"],tableData:[]}},methods:Object(o["a"])({},Object(l["b"])(["setPageLock","updateCustID"]),{getCustomersAndSetup:function(){var t=this;this.selection=[];var e=new Object;this.$route.query&&this.$route.query[0].field_name?(Object.keys(this.$route.query).map(function(s){var a=t.$route.query[s];t.filters.push(a.title),e[a.field_name]=a.option}),this.$store.dispatch("updateFilterData",this.$route.query)):Object.keys(this.$store.state.filterData).map(function(s){var a=t.$store.state.filterData[s];t.filters.push(a.title),e[a.field_name]=a.option}),this.remoteDataMsg="資料讀取中，請稍候...";var s=this.filters.join(";");Object(h["X"])(this.$store.state.userInfo.id,e,s).then(function(e){e.header.status&&"200"==e.header.status?e.body.customer_list&&e.body.customer_list.length?t.tableData=e.body.customer_list.map(function(t){var e,s=t.idmark.source1&&"1"==t.idmark.source1?"1":"N",a=t.idmark.source2&&"1"==t.idmark.source2?"2":"N",i=t.idmark.source3&&"1"==t.idmark.source3?"3":"N",n=t.idmark.source4&&"1"==t.idmark.source4?"4":"N",o=t.idmark.source5&&"1"==t.idmark.source5?"5":"N",c=t.idmark.source6&&"1"==t.idmark.source6?"6":"N";return e={index:t.index||"",vip_level:Number(t.vip_level)||0,sex:Number(t.sex)||0,name:t.name||"",id:t.id,mobile:t.mobile||"",phone:t.phone||"",birthday:t.birthday||"",address:t.address||""},Object(r["a"])(e,"index",t.index||""),Object(r["a"])(e,"idmark",[s,a,i,n,o,c]),e}):t.$toast.info({title:"查無資料"}):t.$toast.info({title:"「客戶列表」搜尋失敗"}),t.remoteDataMsg="查無資料，請確認您輸入之資料是否正確"})},submitGroup:function(t){this.panelClose("groupModalOpen")},toggleCheckAll:function(t){this.selection=t?this.tableData.map(function(t){return t.id}):[]},toSearchFilter:function(){var t=this.$route.query;this.$router.push({path:"/search-filter",query:t})},routeToCustDetail:function(t,e){this.updateCustID(e),localStorage.CustID=e,this.$router.push({path:"/detail/CustID/tab/1"})}}),mounted:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.getCustomersAndSetup();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},v=f,b=s("2877"),_=Object(b["a"])(v,a,i,!1,null,null,null);_.options.__file="FilterResult.vue";e["default"]=_.exports},"21e1":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal fade",class:{"is-open":t.open},attrs:{id:"group-modal"}},[s("div",{staticClass:"modal-dialog"},[s("div",{staticClass:"modal-content",class:{"section-loading":t.isLoading_1}},[s("div",{staticClass:"modal-body"},[s("section",{staticClass:"search"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-10 offset-1"},[s("form",{staticClass:"form"},[s("div",{staticClass:"input-group input-lg"},[s("div",{staticClass:"input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",attrs:{type:"text",name:"keyword",id:"keyword",placeholder:"請以關鍵字搜尋一個群組加入或新增一個群組"},domProps:{value:t.keyword},on:{keyup:function(e){t.findGroup()},input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]),s("button",{staticClass:"btn btn-primary btn-icon",attrs:{type:"submit"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.findGroup()}}},[s("i",{staticClass:"icon-search i-24"})])])])])])]),s("section",{staticClass:"maintain"},[s("div",{staticClass:"row"},[t.groupList.length?s("div",{staticClass:"col-10 offset-1"},[s("h4",[t._v(t._s(t.tempSelection))]),s("div",{staticClass:"list recommand"},t._l(t.groupList,function(e,a){return s("a",{key:"recommand-"+a,staticClass:"item",class:{selected:null!==t.selection&&t.selection.grp_id===e.grp_id},attrs:{role:"button"},on:{click:function(s){t.selectGroup(e)}}},[s("h3",[t._v(t._s(e.grp_name))])])}))]):s("div",{staticClass:"col-10 offset-1 text-center"},[s("h3",[t._v("查無此群組名稱，請問是否新增？")]),s("a",{staticClass:"btn btn-border-green",attrs:{role:"button"},on:{click:function(e){t.addNewGroup()}}},[s("i",{staticClass:"icon-add_new"}),s("span",{staticClass:"text"},[t._v("新增群組「"+t._s(t.keyword)+"」")])])])])]),s("section",{staticClass:"action text-right"},[t.error?s("div",{staticClass:"error-block"},[s("span",{staticClass:"error text-center"},[t._v("\n              請先選擇一個欲加入的群組名稱。\n            ")])]):t._e(),s("a",{staticClass:"btn btn-default",on:{click:t.doCancel}},[t._v("\n            取消\n          ")]),s("a",{staticClass:"btn btn-primary",on:{click:t.doSubmit}},[t._v("\n            確認\n          ")])])])])])])},i=[],n=(s("ac6a"),s("8e44")),r=(s("3022"),{name:"GroupModal",props:{open:{type:Boolean,default:!1},custs:{type:Array},currentPage:{type:String,default:""}},data:function(){return{error:!1,isLoading_1:!1,keyword:"",recommandList:[],groupList:[],selection:null,tempSelection:null,selectedMemOri:[]}},watch:{keyword:"initList",open:"getAllGroup"},methods:{getAllGroup:function(){var t=this;this.open&&(this.isLoading_1=!0,Object(n["E"])(this.$store.state.userInfo.id,this.$store.state.userInfo.id).then(function(e){e.body.groups&&e.body.groups.length>0?(t.recommandList=e.body.groups.map(function(t){return{grp_id:t.grp_id,grp_name:t.grp_name}}),t.groupList=t.recommandList.map(function(t){return t}),""!=t.keyword&&t.groupList.forEach(function(e){t.keyword===e.grp_name&&(t.selectGroup(e),t.keyword="")})):(t.recommandList=[],t.groupList=[]),t.isLoading_1=!1}))},initList:function(){this.groupList=this.recommandList.map(function(t){return t})},findGroup:function(){var t=this;""===this.keyword?this.initList():this.groupList=this.recommandList.filter(function(e){return e.grp_name.indexOf(t.keyword)>-1})},select:function(t){console.log(t),this.selection=t},addNewGroup:function(){var t=this,e=this;e.isLoading_1=!0;for(var s=[],a=1;a<e.custs.length+1;a++){var i=e.custs[a-1];if(-1==e.selectedMemOri.indexOf(i)){var r={};r["identity"]=i,s[a]=r}}"customerCreate"===e.currentPage&&(s=[]),Object(n["wb"])(this.$store.state.userInfo.id,null,e.keyword,s).then(function(s){if(200==s.header.status)e.currentPage,t.$toast.info({title:"已新增「".concat(e.keyword,"」群組")});else if(s.body.errList){var a=s.body.errList||[];t.$emit("showError",a)}else t.$toast.info({title:s.header.message});e.getAllGroup()}),e.isLoading_1=!1},doSubmit:function(){var t=this,e=this;"customerCreate"===e.currentPage?this.$emit("submit",this.selection):(this.selection?Object(n["D"])(this.$store.state.userInfo.id,this.selection.grp_id).then(function(s){s?t.selectedMemOri=s.map(function(t){return t.id}):(t.selectedMemOri=[],t.unselectedMemOri=t.custsOfAgnt.map(function(t){return t}));for(var a=t.selectedMemOri.length,i=1;i<e.custs.length+1;i++){var r=e.custs[i-1];-1==e.selectedMemOri.indexOf(r)&&(e.selectedMemOri[a+i]=e.custs[i-1])}Object(n["yb"])(t.$store.state.userInfo.id,t.selection.grp_id,t.selection.grp_name,t.selectedMemOri).then(function(e){if(200==e.header.status)t.$toast.info({title:"已更新「".concat(t.selection.grp_name,"」群組")});else if(e.body.errList){var s=e.body.errList||[];t.$emit("showError",s)}else t.$toast.info({title:e.header.message})})}):this.error=!0,this.$emit("close"))},selectGroup:function(t){this.selection=t},doCancel:function(){this.selection=[],this.$emit("close")}}}),o=r,c=s("2877"),l=Object(c["a"])(o,a,i,!1,null,null,null);l.options.__file="GroupModal.vue";e["a"]=l.exports},"456d":function(t,e,s){var a=s("4bf8"),i=s("0d58");s("5eda")("keys",function(){return function(t){return i(a(t))}})},"5eda":function(t,e,s){var a=s("5ca1"),i=s("8378"),n=s("79e5");t.exports=function(t,e){var s=(i.Object||{})[t]||Object[t],r={};r[t]=e(s),a(a.S+a.F*n(function(){s(1)}),"Object",r)}}}]);
//# sourceMappingURL=chunk-cd9a9684.a61f5da6.js.map